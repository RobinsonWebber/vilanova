<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gerador de Bilhetes</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* ================================================================== */
    /* ESTILOS PARA A TELA (INCLUINDO DARK MODE )                          */
    /* ================================================================== */
    body.dark-mode {
      background-color: #121212 !important;
      color: #e0e0e0 !important;
    }
    body.dark-mode .card {
      background-color: #1e1e1e;
      color: #e0e0e0;
    }
    body.dark-mode .form-control,
    body.dark-mode .form-select {
      background-color: #2a2a2a;
      color: #e0e0e0;
      border-color: #444;
    }
    body.dark-mode .form-control:focus,
    body.dark-mode .form-select:focus {
      background-color: #333;
      color: #fff;
    }

    /* ================================================================== */
    /* ESTILOS OTIMIZADOS PARA IMPRESS√ÉO T√âRMICA (58mm)                   */
    /* ================================================================== */
    @media print {
      /* --- 1. Configura√ß√£o da P√°gina --- */
      @page {
        size: 58mm auto;
        margin: 2mm;
      }

      /* --- 2. Reset agressivo para anular Bootstrap --- */
      body, html {
        background-color: #fff !important;
        width: 100%;
      }

      /* --- 3. Isola a √°rea de impress√£o --- */
      body * { visibility: hidden; }
      .print-area, .print-area * { visibility: visible; }
      .print-area {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }

      /* --- 4. For√ßa estilos de alto contraste --- */
      .print-area * {
        font-family: Arial, sans-serif !important;
        color: #000000 !important;
        font-weight: 600 !important;
        font-size: 12pt !important;
        line-height: 1.2 !important;
        text-shadow: none !important;
        background: transparent !important;
      }

      /* --- 5. Aumenta o peso de t√≠tulos e negritos --- */
      .print-area b,
      .print-area strong,
      .print-area .titulo {
        font-weight: 700 !important;
      }

      /* --- 6. Estilos para linhas e bordas --- */
      .print-area .card { border: none !important; }
      .print-area hr {
        border: none !important;
        border-top: 2px dashed #000000 !important;
        margin: 8px 0 !important;
        height: 1px;
      }

      /* --- 7. Garante que a imagem seja impressa corretamente --- */
      .print-area img {
        max-width: 100% !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      /* --- 8. JUSTIFICA O TEXTO DA OBSERVA√á√ÉO --- */
      .print-area .texto-obs {
        text-align: justify !important;
        text-justify: inter-word !important;
      }
    }
  </style>
</head>
<body class="bg-light">

  <div class="container py-4">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="m-0">üìú Bilhetes</h2>
          <button class="btn btn-outline-secondary btn-sm" onclick="toggleDarkMode()">üåô</button>
        </div>
        <div class="card shadow p-4">
          <h4 class="text-center mb-4">Gerador de Bilhete</h4>
          <div class="mb-3">
            <label class="form-label">Nome do aluno</label>
            <input type="text" id="nome" class="form-control">
          </div>
          <div class="mb-3">
            <label class="form-label">Turma</label>
            <input type="text" id="turma" class="form-control">
          </div>
          <div class="mb-3">
            <label class="form-label">Observa√ß√µes</label>
            <textarea id="obs" class="form-control" rows="3"></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Data</label>
            <input type="date" id="data" class="form-control">
          </div>
          <div class="d-grid gap-2">
            <button onclick="gerarBilhete()" class="btn btn-primary">Gerar Bilhete</button>
            <button onclick="window.print()" class="btn btn-success">Imprimir</button>
          </div>
        </div>
        <div id="printArea" class="print-area mt-4" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function gerarBilhete( ) {
      const nome = document.getElementById("nome").value;
      const turma = document.getElementById("turma").value;
      const obs = document.getElementById("obs").value;
      const dataInput = document.getElementById("data").value;
      const data = dataInput ? dataInput.split("-").reverse().join("/") : "";

      // AJUSTE: A tag <h1> foi fechada corretamente e as linhas <p> foram trocadas por <hr>
      // AJUSTE: A vari√°vel ${obs} foi envolvida em uma <div> com a classe "texto-obs"
      const conteudo = `
        <div>
          <div style="text-align: center;">
            <img src="https://robinsonwebber.github.io/vilanova/logo_definitivo_escola.jpg" alt="Logo da Escola" width="130" height="160">
          </div>
          <div class="text-center titulo" style="font-size: 14pt !important;">E.M.E.B. VILA NOVA</div>
          <div class="text-center" style="font-size: 10pt !important;">Rua Onze Horas, Rosa do Mar, Passo de Torres ‚Äì SC</div>
          <hr>
          <b>Prof.:</b> Robinson Webber  

          <b>Disc.:</b> Inform√°tica  

          <hr>
          Senhores pais e/ou respons√°veis, viemos atrav√©s deste comunicar que o(a ) aluno(a):  
          
          <hr>

          <span class="titulo">${nome} - Turma: ${turma}</span>  
  

          
          <!-- AQUI EST√Å O AJUSTE PRINCIPAL -->
          <div class="texto-obs">${obs}</div>  

          
          <b>Data:</b> ${data}  
  

          _____________________  

          Assinatura professor  
          <br><br>

          _____________________  

          Assinatura respons√°vel
        </div>
        <br><br>
        <hr style="margin: 20px 0;">

        <div>
          <div class="text-center titulo">Comprovante de Entrega</div>
          <hr>
          <b>Aluno:</b> ${nome} - Turma: ${turma}  

          <b>Data:</b> ${data}  

          <b>Motivo:</b> <div class="texto-obs" style="display: inline;">${obs}</div>  
          <br><br>

          ___________________  

          Assinatura aluno
        </div><br><br>
      `;

      document.getElementById("printArea").innerHTML = conteudo;
      document.getElementById("printArea").style.display = "block";
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }
  </script>
</body>
</html>